from ..encoding import Encoding

PSM_HS = [
    [-.002, -.010, 0.016, -.018, -.020, -.020, -.020, -.042, -.048, 0.000,
     0.000, 0.008, -.038, -.024, 0.002, -.012, -.006, -.036, -.032, -.044],

    [-.004, -.032, 0.006, 0.008, -.031, 0.008, -.019, 0.000, -.015, -.105,
     0.000, 0.030, -.019, -.020, 0.008, -.024, -.006, -.022, -.021, -.008],

    [0.002, -.027, -.002, 0.000, -.005, 0.000, -.011, 0.022, 0.002, 0.000,
     0.000, 0.057, -.002, 0.018, -.012, 0.022, -.004, -.004, 0.006, -.006],

    [0.030, 0.012, -.024, -.014, 0.016, 0.008, 0.006, 0.028, -.017, 0.000,
     0.000, 0.008, -.006, 0.002, -.025, -.014, 0.002, 0.000, -.004, 0.004],

    [-.022, -.005, -.039, 0.000, 0.004, -.024, 0.019, 0.009, -.027, 0.000,
     0.103, 0.014, -.010, -.017, -.016, -.005, -.031, -.029, -.004, 0.012],

    [-.032, -.004, 0.006, 0.028, -.014, -.020, -.026, -.024, -.010, 0.074,
     0.087, 0.014, -.006, -.028, 0.002, -.024, -.016, -.032, -.012, -.002],

    [-.013, -.004, 0.025, -.025, 0.021, -.023, 0.002, -.029, -.021, 0.000,
     -.059, 0.076, 0.014, -.023, -.008, 0.031, -.009, 0.010, -.006, -.002],

    [-.014, 0.002, -.002, 0.002, 0.044, -.014, -.006, -.008, 0.044, 0.000,
     -.132, -.018, 0.016, 0.008, 0.010, 0.018, 0.014, 0.014, -.016, -.006],

    [-.037, 0.006, -.016, -.018, 0.012, -.010, 0.008, -.027, -.019, 0.000,
     0.000, -.043, 0.040, -.004, -.020, -.008, -.024, 0.022, -.010, 0.017],

    [0.004, 0.010, 0.002, 0.040, -.025, -.024, 0.008, 0.006, 0.018, -.012,
     0.000, -.005, -.008, 0.020, 0.002, 0.002, -.006, -.006, -.002, 0.032],

    [0.025, -.004, -.022, 0.002, -.002, 0.024, 0.022, 0.013, -.006, 0.000,
     0.000, -.027, 0.014, -.008, 0.021, -.006, 0.047, 0.010, 0.029, 0.016],

    [0.014, 0.020, 0.020, 0.010, 0.010, 0.032, 0.010, 0.036, 0.016, 0.000,
     0.000, 0.014, 0.042, 0.014, 0.014, 0.010, 0.032, 0.020, 0.024, 0.010],

    [0.004, 0.004, 0.014, -.002, 0.000, 0.012, 0.002, -.017, -.012, 0.000,
     0.000, -.045, -.016, 0.018, 0.006, 0.010, -.002, -.008, -.008, -.004],

    [0.023, 0.016, -.008, -.023, -.012, 0.025, -.017, 0.006, 0.081, 0.042,
     0.000, -.027, -.027, 0.016, 0.009, 0.006, -.008, 0.023, 0.037, -.014],

    [0.019, 0.019, 0.035, 0.019, 0.008, 0.047, 0.015, 0.005, 0.012, 0.000,
     0.000, -.018, -.004, 0.029, -.002, 0.003, 0.012, 0.025, 0.047, 0.025],

    [0.004, -.004, -.010, -.010, -.008, -.020, 0.006, 0.022, -.002, 0.000,
     0.000, -.043, 0.008, -.002, 0.010, -.009, 0.004, 0.014, -.027, -.028]
]

PSM_MM = [
    [-.034, -.034, -.025, -.027, 0.000, -.023, -.004, -.068, -.058, 0.000,
     0.000, -.019, -.005, 0.033, 0.013, 0.000, -.011, -.002, -.026, -.006],

    [-.025, -.032, -.002, -.013, -.002, -.006, -.015, 0.041, 0.004, -.104,
     0.000, 0.121, -.032, 0.010, -.002, 0.004, -.011, -.017, -.017, 0.000],

    [0.026, -.019, 0.013, 0.008, 0.002, 0.017, -.008, -.026, -.008, 0.000,
     0.000, 0.117, -.027, 0.002, -.013, -.007, 0.003, -.023, -.002, 0.006],

    [0.002, -.013, 0.011, 0.006, -.017, -.005, 0.005, -.011, -.015, 0.000,
     0.000, 0.007, -.044, 0.013, -.002, 0.006, -.008, -.030, 0.010, -.030],

    [-.015, -.021, -.009, -.008, -.017, -.015, 0.000, -.019, -.002, 0.000,
     0.225, 0.010, 0.023, -.030, -.006, -.013, -.023, 0.002, -.002, -.024],

    [-.013, 0.006, -.014, -.008, 0.015, 0.017, 0.000, -.017, -.010, 0.000,
     0.106, 0.060, 0.032, -.005, 0.021, 0.014, 0.022, 0.017, 0.006, 0.007],

    [0.017, 0.032, 0.006, -.002, 0.004, 0.002, 0.027, 0.002, 0.036, 0.000,
     -.136, 0.083, 0.017, -.007, -.002, 0.020, 0.013, 0.028, 0.019, 0.002],

    [0.027, -.019, 0.004, 0.008, 0.013, -.004, 0.023, 0.014, 0.045, 0.000,
     -.195, -.047, 0.040, 0.021, -.003, 0.017, 0.007, 0.011, 0.021, -.005],

    [-.032, 0.032, 0.017, 0.007, -.004, 0.013, -.023, -.004, -.021, 0.000,
     0.000, -.039, 0.074, 0.004, -.027, -.030, -.030, -.021, -.015, 0.015],

    [0.007, 0.015, 0.013, 0.025, -.006, 0.036, -.004, 0.036, -.011, 0.046,
     0.000, -.049, 0.019, -.002, 0.004, 0.008, 0.030, 0.038, 0.004, 0.013],

    [0.027, 0.002, 0.010, 0.002, -.007, -.008, 0.028, -.019, -.017, 0.000,
     0.000, -.031, 0.031, -.015, 0.003, 0.015, 0.000, -.012, 0.004, 0.005],

    [0.002, 0.025, -.010, 0.015, 0.010, -.007, 0.012, 0.029, 0.004, 0.000,
     0.000, -.017, 0.019, 0.010, 0.006, -.006, 0.015, 0.019, 0.004, 0.006],

    [-.017, 0.019, -.009, 0.013, 0.004, 0.002, -.036, 0.015, -.024, 0.000,
     0.000, -.061, -.034, -.013, 0.025, 0.015, -.009, -.013, 0.013, -.019],

    [0.030, -.002, -.007, 0.011, -.006, 0.004, 0.000, 0.008, 0.017, 0.057,
     0.000, -.019, -.038, 0.006, 0.014, -.011, 0.017, 0.006, -.013, 0.026],

    [0.004, 0.014, 0.019, -.015, 0.034, 0.003, -.004, -.002, 0.036, 0.000,
     0.000, -.023, -.023, 0.004, 0.000, -.013, 0.009, 0.006, 0.017, 0.017],

    [-.006, -.006, -.017, -.022, -.023, -.025, 0.000, 0.019, 0.023, 0.000,
     0.000, -.091, -.053, -.036, -.032, -.021, -.021, -.008, -.025, -.013]
]

PSM_SC = [
    [-.042, 0.000, -.003, 0.012, 0.009, 0.028, 0.025, -.045, -.003, 0.025, 0.016, -.077, -.083, -.061, 0.000,
     0.000, -.001, -.032, -.032, -.019, -.038, 0.019, 0.022, 0.006, 0.006, 0.022, 0.013, -.001, -.052, -.032],

    [0.003, -.035, -.032, 0.003, 0.028, -.051, -.003, 0.034, 0.022, -.006, -.010, -.022, 0.012, -.010, -.065,
     0.000, -.032, -.038, 0.035, 0.026, -.016, -.029, -.013, -.022, 0.015, -.026, 0.003, -.013, 0.006, -.013],

    [0.016, -.016, 0.041, 0.009, 0.010, -.022, 0.012, 0.003, -.006, -.010, 0.000, 0.041, 0.010, -.032, 0.000,
     0.000, -.042, 0.016, 0.019, 0.003, 0.013, 0.003, 0.003, 0.013, -.026, 0.000, 0.016, -.013, -.007, 0.003],

    [-.023, 0.003, 0.025, -.004, -.003, 0.026, -.013, -.003, -.060, -.003, 0.012, 0.098, -.039, -.042, 0.000,
     0.000, 0.131, 0.041, -.025, 0.025, -.004, -.029, 0.012, 0.015, 0.026, 0.006, 0.019, 0.025, 0.032, -.009],

    [-.042, 0.013, 0.018, 0.026, -.007, -.013, -.016, -.026, 0.019, 0.019, 0.025, -.020, -.026, 0.038, 0.000,
     0.056, -.007, -.029, 0.003, 0.000, -.019, -.023, -.032, -.003, -.016, -.006, 0.013, -.016, -.009, -.012],

    [0.012, -.032, -.035, -.023, -.026, -.013, -.048, 0.009, -.013, 0.038, -.035, -.003, 0.050, 0.032, 0.047,
     0.044, -.010, -.022, -.051, -.032, -.057, 0.000, -.003, -.044, -.026, 0.012, -.039, -.029, 0.032, -.032],

    [-.010, -.007, 0.012, 0.016, -.026, -.003, -.022, -.010, 0.009, -.004, -.020, -.026, -.035, -.013, 0.000,
     -.048, 0.016, 0.000, 0.006, -.003, 0.032, -.013, 0.016, 0.035, -.026, -.025, 0.000, 0.006, 0.000, 0.010],

    [0.025, 0.012, -.029, -.045, 0.022, 0.044, 0.009, 0.013, 0.025, 0.003, 0.044, 0.016, 0.012, 0.172, 0.000,
     -.052, 0.045, -.003, 0.007, 0.025, 0.003, 0.016, -.003, 0.038, -.012, 0.006, 0.003, -.025, -.009, 0.035],

    [0.003, 0.003, -.013, -.013, -.009, -.016, -.029, 0.009, 0.019, -.010, 0.022, -.016, -.057, 0.009, 0.000,
     0.000, -.016, -.025, 0.035, -.006, -.016, 0.006, 0.003, 0.006, 0.022, -.020, -.009, -.019, 0.009, 0.019],

    [-.026, 0.003, 0.019, -.006, 0.035, 0.000, 0.009, 0.003, 0.009, -.003, -.003, 0.006, 0.102, -.020, -.071,
     0.000, -.019, -.023, 0.003, -.019, 0.009, 0.000, 0.023, 0.003, 0.000, 0.009, -.028, 0.022, -.010, -.006],

    [-.010, -.003, -.045, 0.003, 0.012, 0.022, -.010, -.016, -.016, 0.010, -.029, -.029, -.036, -.032, 0.000,
     0.000, -.020, -.016, -.023, 0.000, 0.000, 0.003, -.007, 0.006, 0.022, -.010, 0.003, 0.028, -.003, -.026],

    [0.019, 0.000, 0.013, -.003, 0.000, -.004, 0.022, -.013, -.006, -.013, 0.025, -.007, -.013, -.013, 0.000,
     0.000, 0.006, -.026, -.006, 0.015, 0.016, 0.026, -.029, -.004, -.003, 0.000, 0.003, -.004, 0.031, -.013],

    [0.032, 0.016, 0.019, 0.019, -.013, 0.022, 0.009, 0.012, -.028, -.016, -.022, 0.012, 0.022, -.051, 0.000,
     0.000, 0.010, 0.083, 0.029, -.019, 0.038, 0.022, 0.019, 0.013, -.009, 0.054, -.016, 0.015, -.001, 0.045],

    [-.004, 0.032, 0.022, -.010, -.023, -.013, 0.029, -.007, 0.038, -.013, 0.016, 0.022, 0.063, 0.044, 0.088,
     0.000, 0.006, 0.048, 0.003, -.017, 0.044, 0.007, 0.019, -.016, -.003, -.019, 0.000, 0.031, -.029, 0.013],

    [0.006, 0.000, -.029, 0.009, 0.007, -.003, 0.003, 0.028, -.003, 0.019, 0.003, 0.009, 0.006, 0.006, 0.000,
     0.000, -.045, 0.009, -.013, 0.009, -.010, -.004, 0.000, -.013, 0.010, 0.003, 0.009, 0.006, -.016, 0.006],

    [0.038, 0.012, 0.015, 0.006, -.016, -.003, 0.023, 0.006, -.003, -.035, -.045, -.006, 0.009, -.029, 0.000,
     0.000, -.023, 0.019, 0.012, 0.013, 0.006, -.004, -.029, -.032, 0.022, -.006, 0.012, -.016, 0.025, 0.016]
]


def encode_psdp(sequence: str, species: str = 'hs'):
    psm = []
    result = []

    match species:
        case 'hs':
            psm = PSM_HS
        case 'sc':
            psm = PSM_SC
        case 'mm':
            psm = PSM_MM

    for i in range(len(sequence) - 1):
        match sequence[i: i + 2]:
            case 'AA':
                result.append(psm[0][i])
            case 'AU':
                result.append(psm[1][i])
            case 'AT':
                result.append(psm[1][i])
            case 'AC':
                result.append(psm[2][i])
            case 'AG':
                result.append(psm[3][i])
            case 'UA':
                result.append(psm[4][i])
            case 'UU':
                result.append(psm[5][i])
            case 'UC':
                result.append(psm[6][i])
            case 'UG':
                result.append(psm[7][i])
            case 'CA':
                result.append(psm[8][i])
            case 'CU':
                result.append(psm[9][i])
            case 'CC':
                result.append(psm[10][i])
            case 'CG':
                result.append(psm[11][i])
            case 'GA':
                result.append(psm[12][i])
            case 'GU':
                result.append(psm[13][i])
            case 'GC':
                result.append(psm[14][i])
            case 'GG':
                result.append(psm[15][i])

    return tuple(result)


class PSDP(Encoding):
    def __init__(self, species: str = 'hs'):
        self._species = species

    @property
    def name(self) -> str:
        return 'psdp'

    def encode(self, sequence: str, label: bool = False) -> tuple[float, ...]:
        return encode_psdp(sequence, self._species)
