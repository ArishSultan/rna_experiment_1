from ..encoding import Encoding

PSM_HS = [
    [0.026, -.056, -.004, -.024, -.038, -.004, -.043, 0.008, -.077, -.105, 0.0,
     0.103, -.065, -.024, -.026, -.028, -.014, -.062, -.051, -.054, -.021],

    [-.080, -.010, -.010, 0.006, 0.055, -.081, -.012, -.053, -.012, 0.074, 0.0,
     0.087, 0.014, -.059, -.012, 0.021, -.041, -.037, -.039, 0.002, 0.008],

    [0.006, 0.032, -.016, 0.034, -.004, 0.022, 0.049, 0.028, 0.010, -.012, 0.0,
     -.059, 0.089, 0.022, 0.016, -.002, 0.049, 0.047, 0.041, 0.074, 0.032],

    [0.049, 0.035, 0.030, -.016, -.012, 0.063, 0.007, 0.017, 0.079, 0.042, 0.0,
     -.132, -.038, 0.061, 0.023, 0.010, 0.006, 0.053, 0.049, -.022, -.021]
]

PSM_MM = [
    [-.032, -.0980, -.0050, -.026, -.017, -.017, -.023, -.064, -.076, -.104, 0.0,
     0.225, -0.108, 0.0590, -.004, 0.004, -.027, -.072, -.034, -.029, -.034],

    [0.017, -.0020, -.0130, -.011, 0.015, 0.000, 0.051, -.019, 0.067, 0.000, 0.0,
     0.106, 0.1120, -0.019, 0.011, 0.038, 0.017, 0.057, 0.045, -.020, 0.045],

    [0.004, 0.0740, 0.0300, 0.049, -.006, 0.034, 0.013, 0.042, -.045, 0.046, 0.0,
     -.136, 0.1440, -.0020, -.015, -.012, 0.015, 0.023, -.002, 0.038, 0.030],

    [0.010, 0.0260, -.0120, -.013, 0.008, -.017, -.041, 0.041, 0.053, 0.057, 0.0,
     -.195, -0.149, -.0380, 0.008, -.030, -.004, -.008, -.009, 0.010, -.040]
]

PSM_SC = [
    [-.045, -.049, 0.031, 0.021, 0.044, -.020, 0.022, -.011, -.049, 0.005, 0.018, 0.041, -.100, -.144, -.065, 0.0,
     0.056, -.014, -.004, 0.034, -.046, -.036, 0.025, 0.012, 0.021, 0.002, 0.050, -.001, -.021, -.052, 0.019],

    [-.013, -.014, -.032, -.027, -.036, 0.016, -.078, -.014, 0.041, 0.056, 0.015, -.033, 0.002, 0.229, 0.047, 0.0,
     0.044, -.055, -.036, -.011, -.042, -.020, -.023, 0.025, -.080, -.013, -.024, -.065, 0.012, -.001, -.039],

    [-.013, 0.003, -.026, -.020, 0.038, 0.003, -.007, -.017, 0.006, -.017, 0.015, -.045, -.003, -.055, -.071, 0.0,
     -.048, -.090, 0.009, -.010, 0.009, 0.034, -.010, 0.012, 0.040, -.020, -.033, 0.028, 0.028, -.026, -.007],

    [0.073, 0.060, 0.028, 0.025, -.045, 0.002, 0.063, 0.041, 0.002, -.046, -.049, 0.038, 0.102, -.030, 0.088, 0.0,
     -.052, 0.159, 0.031, -.014, 0.079, 0.022, 0.009, -.048, 0.018, 0.031, 0.006, 0.038, -.020, 0.079, 0.028]
]


def encode_psnp(sequence: str, species: str = 'hs'):
    psm = []
    result = []

    match species:
        case 'hs':
            psm = PSM_HS
        case 'sc':
            psm = PSM_SC
        case 'mm':
            psm = PSM_MM

    for i in range(len(sequence)):
        match sequence[i]:
            case 'A':
                result.append(psm[0][i])
            case 'U':
                result.append(psm[1][i])
            case 'T':
                result.append(psm[1][i])
            case 'C':
                result.append(psm[2][i])
            case 'G':
                result.append(psm[3][i])

    return tuple(result)


class PSNP(Encoding):
    def __init__(self, species: str = 'hs'):
        self._species = species

    @property
    def name(self) -> str:
        return 'psnp'

    def encode(self, sequence: str, label: bool = False) -> tuple[float, ...]:
        return encode_psnp(sequence, self._species)
