from typing import Any

from ..encoding import Encoding

PSM_HS = [
    [-.002, 0.004, 0.008, -.015, 0.000, -.008, -.012, -.012, 0.000, 0.000, 0.000, -.016, -.010, -.016, 0.002, 0.000,
     -.018, -.024, -.039],
    [0.009, 0.004, 0.041, -.036, -.004, -.028, 0.000, -.012, -.097, 0.000, 0.000, 0.004, -.024, 0.020, -.008, -.033,
     -.004, -.008, 0.004],
    [-.012, -.028, -.012, -.016, -.008, 0.004, -.008, -.016, 0.000, 0.000, 0.000, 0.000, -.024, -.021, 0.016, 0.004,
     -.013, -.008, 0.004],
    [0.004, -.004, -.012, 0.045, -.029, 0.000, -.009, -.032, 0.000, 0.000, 0.000, 0.045, -.008, -.017, -.008, 0.004,
     0.041, -.008, 0.004],
    [0.000, -.041, 0.012, -.024, -.020, 0.016, -.016, -.004, 0.000, -.057, 0.000, -.012, -.024, -.020, -.012, -.016,
     -.008, -.020, 0.012],
    [0.000, -.020, 0.024, -.012, -0.02, 0.000, -.004, -.005, -.028, 0.016, 0.000, 0.033, -.008, -.021, -.008, -.029,
     -.012, -.012, -.053],
    [0.004, 0.004, 0.004, 0.008, -0.02, -.012, -.012, -.004, 0.000, -.073, 0.000, 0.029, -.004, -.024, 0.037, -.008,
     0.016, -.004, 0.008],
    [-.012, -.009, -.029, 0.045, 0.000, 0.012, -.004, 0.012, 0.000, -.097, 0.000, 0.012, 0.000, 0.024, 0.000, 0.004,
     -.008, -.008, -.008],
    [0.004, -.008, -.011, -.020, -.011, -.017, -.033, -.023, 0.000, 0.000, 0.000, 0.018, -.015, -.025, 0.002, -.004,
     -.017, -.017, -.041],
    [-.008, -.012, 0.014, 0.000, -.004, -.002, -.006, 0.026, 0.002, 0.000, 0.000, -.006, 0.008, 0.006, -.008, 0.000,
     0.000, -.008, 0.006],
    [-.002, -.008, 0.000, 0.004, 0.010, 0.010, 0.004, -.002, 0.000, 0.000, 0.000, 0.022, -.010, 0.018, -.002, 0.010,
     -.004, -.006, 0.006],
    [0.006, 0.006, 0.002, 0.002, 0.000, 0.000, 0.012, 0.008, 0.000, 0.000, 0.000, 0.006, 0.004, 0.002, -.002, 0.016,
     -.002, 0.002, -.004],
    [0.010, 0.008, -.012, -.002, -.002, 0.002, -.004, -.008, 0.000, 0.000, 0.000, -.006, -.008, -.012, -.004, -.010,
     0.000, -.008, -.002],
    [0.012, -.008, 0.000, 0.000, 0.000, 0.000, 0.002, 0.036, -.017, 0.000, 0.000, 0.004, 0.004, 0.010, 0.000, -.002,
     -.002, 0.018, 0.002],
    [-.002, 0.016, -.002, 0.004, 0.026, 0.008, -.012, 0.002, 0.000, 0.000, 0.000, 0.002, 0.006, 0.004, 0.020, -.008,
     0.004, 0.006, 0.004],
    [0.010, -.004, -.010, -.016, -.008, -.002, 0.020, -.002, 0.000, 0.000, 0.000, 0.008, -.008, 0.000, 0.000, 0.006,
     0.000, -.016, -.008],
    [-.018, 0.004, -.018, 0.004, -.008, -.010, 0.000, -.006, 0.000, 0.000, 0.008, 0.004, -.012, -.006, -.012, -.006,
     -.004, -.010, 0.000],
    [-.016, 0.004, -.033, -.004, 0.020, -.016, 0.012, 0.016, -.052, 0.000, 0.061, -.004, -.025, 0.000, -.033, 0.012,
     -.024, -.032, -0.02],
    [0.004, -.004, 0.000, 0.012, -.004, -.004, 0.020, 0.012, 0.000, 0.000, 0.113, 0.012, 0.032, -.008, 0.032, 0.000,
     -.008, -.004, -.004],
    [0.004, -.016, -.008, -.016, 0.008, -.008, 0.004, 0.000, 0.000, 0.000, 0.016, 0.012, -.004, -.012, -.008, -.008,
     -.020, 0.000, 0.016],
    [-.024, -.020, 0.012, 0.012, -.004, 0.016, 0.012, -.036, 0.000, 0.097, 0.028, 0.004, -.012, -.029, 0.008, -.036,
     -.012, 0.008, 0.000],
    [-.020, 0.000, 0.008, 0.000, -.004, -.033, -.024, -.016, -.020, 0.077, 0.028, -.024, 0.004, 0.004, -.012, 0.000,
     -.036, 0.012, 0.016],
    [-.016, 0.013, -.012, 0.016, -.012, 0.012, -.024, -.004, 0.000, 0.028, 0.154, -.004, -.024, 0.004, -.004, -.017,
     0.020, -.041, -.021],
    [-.004, 0.000, 0.004, 0.028, -.008, -.037, -.016, 0.008, 0.000, -.052, -.037, 0.053, 0.020, -.037, 0.012, 0.004,
     -.004, -.045, -0.02],
    [-.018, 0.004, -.019, 0.014, 0.000, -.016, -.002, -.018, 0.000, 0.000, -.035, 0.031, -.006, -.014, -.018, -.018,
     -.008, -.018, 0.002],
    [-.008, -.004, 0.010, -.026, 0.004, -.010, 0.000, -.004, -.021, 0.000, -.005, 0.016, 0.008, -.002, 0.000, 0.010,
     -.008, -.004, -.008],
    [-.004, -.002, 0.006, -.012, 0.002, -.004, 0.000, -.010, 0.000, 0.000, -.027, 0.008, 0.000, -.016, -.004, 0.032,
     -.004, 0.014, -.004],
    [0.000, 0.002, 0.008, 0.004, 0.006, -.002, 0.004, -.002, 0.000, 0.000, 0.014, 0.026, 0.000, 0.004, 0.002, 0.000,
     0.008, 0.008, 0.004],
    [-.010, 0.002, -.006, 0.002, 0.012, 0.002, -.008, -.014, 0.000, 0.000, -.045, -.006, 0.008, 0.004, 0.014, 0.008,
     0.006, -.010, 0.008],
    [-.004, -.002, -.008, -.004, 0.010, -.008, -.008, 0.002, 0.044, 0.000, -.027, -.020, -.008, 0.000, -.002, 0.002,
     0.002, 0.004, -.014],
    [0.010, 0.008, 0.008, -.004, 0.018, -.008, 0.008, 0.002, 0.000, 0.000, -.018, -.004, 0.030, -.002, 0.004, 0.012,
     0.010, 0.020, 0.008],
    [-.010, -.006, 0.004, 0.008, 0.004, 0.000, 0.002, 0.002, 0.000, 0.000, -.043, 0.012, -.014, 0.006, -.006, -.004,
     -.004, 0.000, -.018],
    [-.002, -.002, -.002, -.006, -.008, -.010, -.016, -.016, 0.000, 0.000, 0.000, -.012, 0.016, 0.004, -.002, 0.000,
     -.012, -.002, 0.004],
    [-.028, 0.000, 0.016, -.004, -.004, 0.008, 0.000, -.020, 0.036, 0.000, 0.000, -.024, 0.004, -.012, -.016, -.012,
     -.004, 0.008, 0.012],
    [-.036, 0.020, -.012, 0.000, 0.008, -.020, 0.029, 0.012, 0.000, 0.000, 0.000, -.016, 0.025, 0.008, -.024, -.020,
     0.016, 0.028, -.033],
    [-.004, -.004, -.033, -.021, 0.037, 0.012, 0.021, -.012, 0.000, 0.000, 0.000, -.020, 0.021, -.012, 0.004, 0.016,
     -.037, 0.013, -.008],
    [0.020, -.008, -.004, 0.012, -.016, -.020, 0.024, -.028, 0.000, 0.045, 0.000, 0.008, 0.008, 0.037, 0.000, -.012,
     -.012, 0.000, -.012],
    [0.008, 0.016, 0.016, 0.016, -.012, -.020, -.012, 0.012, 0.037, 0.057, 0.000, -.020, -.016, 0.020, -.024, -.008,
     -.004, -.037, 0.008],
    [-.012, 0.012, -.024, 0.024, -.020, -.008, 0.008, -.020, 0.000, -.061, 0.000, 0.008, 0.000, -.024, 0.016, 0.016,
     -.012, 0.020, 0.000],
    [-.008, 0.000, 0.017, 0.029, 0.000, 0.000, -.004, 0.049, 0.000, -.064, 0.000, -.004, -.008, 0.008, 0.012, 0.009,
     0.017, 0.004, 0.000],
    [-.002, -.002, -.008, -.004, -.012, -.006, -.021, -.014, 0.000, 0.000, 0.000, -.021, 0.006, -.002, -.002, -.012,
     0.014, -.008, 0.000],
    [0.016, 0.004, 0.000, -.004, -.018, 0.012, 0.014, 0.000, -.006, 0.000, 0.000, -.014, 0.004, -.004, 0.014, -.006,
     0.008, -.002, 0.024],
    [0.002, -.014, -.012, 0.002, 0.004, 0.004, 0.004, 0.004, 0.000, 0.000, 0.000, -.008, 0.008, 0.002, 0.000, 0.006,
     0.008, 0.004, 0.004],
    [0.006, 0.006, -.004, 0.002, 0.016, 0.004, 0.008, 0.006, 0.000, 0.000, 0.000, 0.004, 0.012, 0.000, 0.006, 0.006,
     0.004, 0.014, 0.004],
    [0.004, 0.008, 0.012, 0.004, 0.000, 0.000, -.008, 0.000, 0.000, 0.000, 0.000, 0.010, 0.008, 0.010, 0.000, 0.004,
     -.004, 0.010, 0.002],
    [0.000, 0.000, 0.004, 0.000, 0.008, 0.002, 0.008, 0.008, 0.016, 0.000, 0.000, 0.000, 0.014, 0.002, 0.004, 0.002,
     0.016, 0.006, 0.008],
    [0.000, 0.004, 0.004, 0.006, 0.002, 0.014, 0.004, 0.016, 0.000, 0.000, 0.000, 0.000, 0.000, 0.004, 0.010, 0.006,
     0.006, 0.004, 0.004],
    [0.010, 0.008, 0.000, 0.000, 0.000, 0.016, 0.006, 0.012, 0.000, 0.000, 0.000, 0.004, 0.020, -.002, 0.000, -.002,
     0.014, 0.000, 0.010],
    [0.012, 0.010, -.006, -.004, -.004, 0.008, -.014, -.014, 0.000, 0.000, 0.000, -.014, -.018, 0.020, 0.000, 0.000,
     -.002, 0.004, -.010],
    [-.028, 0.004, -.008, -.016, 0.004, 0.000, -.012, -.012, -.024, 0.000, 0.000, -.012, 0.004, 0.008, 0.008, 0.020,
     -.012, -.008, -.012],
    [-.008, 0.008, 0.024, -.004, 0.004, 0.000, 0.004, -.004, 0.000, 0.000, 0.000, 0.000, 0.004, -.004, 0.020, 0.008,
     -.004, -.004, 0.020],
    [0.020, -.024, 0.024, 0.025, 0.000, 0.008, 0.041, 0.012, 0.000, 0.000, 0.000, -.049, -.004, -.008, -.017, -.008,
     0.016, -.012, -.004],
    [-.004, -.008, -.020, 0.008, -.008, 0.024, -.004, 0.016, 0.000, 0.121, 0.000, -.020, -.004, -.020, -.004, 0.004,
     -.024, 0.004, 0.024],
    [0.004, 0.016, 0.008, -.032, -.004, 0.000, -.008, -.012, 0.162, 0.024, 0.000, 0.000, -.036, 0.000, -.004, 0.004,
     -.012, 0.012, 0.024],
    [0.016, 0.020, -.016, -.008, 0.008, 0.012, -.028, -.012, 0.000, -.012, 0.000, -.004, -.016, 0.028, 0.012, -.008,
     -.004, 0.012, 0.008],
    [0.028, 0.004, 0.012, -.012, -.021, 0.012, 0.008, 0.020, 0.000, -.048, 0.000, -.029, 0.004, 0.025, 0.012, 0.012,
     0.024, 0.016, 0.017],
    [0.012, 0.006, 0.000, 0.002, -.008, 0.027, -.014, -.012, 0.000, 0.000, 0.000, -.026, -.014, 0.022, -.002, 0.004,
     -.004, 0.000, 0.010],
    [0.010, 0.014, 0.016, 0.006, -.006, 0.008, -.002, -.004, 0.012, 0.000, 0.000, -.004, 0.000, 0.002, -.004, -.010,
     -.006, 0.012, 0.010],
    [0.000, 0.002, 0.008, 0.004, 0.008, 0.012, 0.004, 0.002, 0.000, 0.000, 0.000, -.008, -.006, 0.016, 0.000, -.002,
     0.010, 0.016, 0.010],
    [0.008, 0.006, 0.004, 0.002, 0.010, 0.008, 0.012, 0.004, 0.000, 0.000, 0.000, 0.006, -.002, 0.008, 0.004, 0.010,
     0.010, 0.000, 0.006],
    [0.000, -.004, 0.004, -.004, 0.002, -.002, 0.004, 0.010, 0.000, 0.000, 0.000, -.014, 0.010, 0.004, 0.000, -.004,
     -.010, 0.000, -.012],
    [0.008, 0.002, -.018, -.008, 0.006, -.010, 0.004, 0.034, -.002, 0.000, 0.000, -.010, 0.006, -.004, 0.004, -.010,
     0.006, 0.008, -.010],
    [0.010, 0.006, 0.008, 0.002, 0.000, 0.000, 0.004, -.008, 0.000, 0.000, 0.000, -.002, -.008, -.008, 0.008, 0.002,
     0.004, 0.016, 0.008],
    [-.014, -.008, -.004, 0.000, -.016, -.008, -.006, -.014, 0.000, 0.000, 0.000, -.016, 0.000, 0.006, -.002, 0.004,
     0.004, -.010, -.012]
]

PSM_MM = [
    [-.015, -.030, -.023, -.028, -.014, -.002, -.019, -.036, 0.000, 0.000, 0.000, 0.008, 0.004, 0.026, -.008, 0.000,
     -.002, -.005, -.011],
    [-.034, 0.005, 0.000, 0.017, -.013, -.029, 0.013, 0.000, -.114, 0.000, 0.000, -.013, -.004, -.009, 0.047, 0.004,
     -.005, -.013, 0.004],
    [-.004, -.004, -.005, -.004, 0.013, -.017, 0.021, -.013, 0.000, 0.000, 0.000, -.004, -.008, 0.013, -.021, 0.004,
     -.008, 0.000, -.013],
    [0.000, -.008, 0.000, -.013, 0.030, 0.005, -.004, -.051, 0.000, 0.000, 0.000, -.038, -.004, 0.013, 0.017, -.009,
     -.005, 0.017, -.022],
    [-.038, -.017, 0.004, -.029, -.012, -.008, 0.000, 0.009, 0.000, 0.021, 0.000, 0.038, -.017, 0.017, -.021, -.021,
     -.013, -.030, -.034],
    [0.000, -.038, -.026, 0.017, 0.004, -.004, 0.000, 0.026, 0.009, -.017, 0.000, 0.064, -.012, -.013, -.004, 0.012,
     -.009, -.017, -.009],
    [0.000, 0.021, 0.025, 0.000, -.012, -.013, -.012, 0.012, 0.000, -.059, 0.000, 0.064, -.021, -.005, 0.021, 0.005,
     0.017, -.008, 0.005],
    [-.012, -.030, -.008, -.013, 0.017, 0.012, -.017, 0.034, 0.000, -.152, 0.000, 0.076, -.013, 0.022, 0.000, 0.013,
     -.017, 0.021, 0.004],
    [0.002, -.034, -.030, -.022, -.019, -.002, -.021, -.053, 0.000, 0.000, 0.000, 0.059, -.013, 0.022, -.039, -.032,
     -.010, -.015, -.005],
    [0.004, -.013, 0.013, 0.002, 0.009, 0.000, 0.004, -.007, -.008, 0.000, 0.000, 0.011, -.002, 0.005, -.004, 0.010,
     0.002, -.009, 0.009],
    [0.003, 0.002, 0.011, 0.000, -.002, 0.012, -.014, -.006, 0.000, 0.000, 0.000, 0.043, -.011, -.004, 0.026, 0.007,
     -.008, -.002, -.019],
    [0.002, -.004, -.004, 0.000, 0.000, 0.004, 0.004, 0.004, 0.000, 0.000, 0.000, 0.013, 0.002, 0.007, -.004, 0.009,
     0.017, -.002, 0.002],
    [0.002, 0.000, -.003, 0.007, 0.004, -.015, 0.010, -.022, 0.000, 0.000, 0.000, 0.004, -.002, -.003, 0.011, -.006,
     -.015, -.017, -.015],
    [-.002, -.004, 0.009, -.007, 0.007, 0.000, 0.000, 0.002, -.015, 0.000, 0.000, -.003, -.006, 0.008, 0.000, 0.017,
     0.002, -.007, 0.006],
    [0.000, 0.013, 0.013, 0.021, -.002, 0.000, 0.000, 0.015, 0.000, 0.000, 0.000, 0.003, -.009, 0.013, -.002, 0.006,
     0.008, 0.007, 0.010],
    [0.002, -.021, -.008, -.015, -.025, 0.011, -.006, -.006, 0.000, 0.000, 0.000, 0.002, -.027, -.006, -.011, -.010,
     -.004, -.013, 0.008],
    [0.000, -.015, -.002, -.002, -.002, -.002, -.022, -.006, 0.000, 0.000, -.019, 0.017, 0.015, -.026, 0.002, -.007,
     0.000, -.007, 0.006],
    [-.022, -.005, 0.000, -.004, -.005, -.013, 0.034, -.017, -.004, 0.000, 0.242, -.013, 0.000, -.008, -.034, -.017,
     -.013, 0.004, -.013],
    [-.004, 0.004, 0.012, 0.000, 0.009, -.021, 0.017, -.013, 0.000, 0.000, 0.233, -.004, 0.004, 0.000, 0.013, 0.000,
     -.021, 0.004, -.004],
    [-.004, -.012, -.026, -.008, -.034, 0.008, -.008, 0.004, 0.000, 0.000, 0.013, 0.004, 0.013, 0.000, 0.004, 0.004,
     -.013, 0.008, 0.000],
    [-.013, 0.004, 0.008, -.004, -.009, -.008, -.009, -.009, 0.000, 0.093, 0.021, 0.038, -.017, 0.000, 0.013, -.013,
     0.021, 0.008, -.009],
    [-.038, -.013, -.022, -.013, 0.030, 0.013, -.025, -.055, -.022, 0.055, 0.118, 0.026, 0.038, 0.017, 0.025, 0.017,
     0.008, -.004, 0.033],
    [0.034, 0.017, -.017, 0.008, 0.008, 0.017, 0.009, 0.004, 0.000, -.085, 0.165, 0.026, 0.009, -.009, 0.013, 0.034,
     0.013, 0.005, -.004],
    [-.009, 0.004, 0.000, -.008, 0.000, 0.013, 0.025, 0.026, 0.000, -.064, -.093, 0.030, 0.034, -.017, -.008, -.009,
     0.000, 0.025, -.009],
    [0.006, 0.000, 0.002, -.019, -.004, -.012, -.017, 0.002, 0.000, 0.000, -.057, 0.055, 0.030, -.032, 0.006, -.004,
     0.002, -.011, 0.010],
    [0.000, 0.011, 0.006, 0.004, 0.010, 0.002, 0.013, 0.005, 0.036, 0.000, -.049, 0.021, -.004, -.009, -.004, 0.017,
     0.017, 0.010, 0.000],
    [0.006, 0.006, -.013, 0.006, -.002, 0.010, 0.006, -.008, 0.000, 0.000, -.031, 0.011, 0.006, 0.009, 0.004, 0.000,
     -.004, 0.024, 0.012],
    [0.004, 0.000, 0.009, 0.004, -.002, 0.000, 0.004, -.002, 0.000, 0.000, -.017, 0.013, 0.000, 0.000, -.006, 0.000,
     -.002, -.002, 0.002],
    [0.017, -.017, 0.010, -.005, -.002, -.013, 0.000, 0.004, 0.000, 0.000, -.061, -.011, 0.007, 0.015, 0.005, 0.015,
     -.002, 0.006, 0.002],
    [-.008, -.002, -.004, -.002, 0.000, 0.006, 0.008, -.004, 0.045, 0.000, -.019, -.017, 0.023, 0.019, 0.000, -.003,
     0.007, 0.002, 0.017],
    [0.004, 0.000, -.006, 0.006, 0.007, -.004, 0.002, 0.004, 0.000, 0.000, -.023, -.007, 0.007, -.008, -.007, -.002,
     0.000, 0.013, 0.012],
    [0.015, 0.000, 0.005, 0.009, 0.009, 0.006, 0.013, 0.011, 0.000, 0.000, -.091, -.013, 0.005, -.005, 0.000, 0.006,
     0.002, -.011, -.011],
    [-.010, 0.000, 0.008, 0.013, 0.000, -.002, -.011, -.015, 0.000, 0.000, 0.000, -.010, 0.036, 0.013, -.011, -.004,
     -.013, -.004, -.002],
    [-.021, 0.008, -.009, -.008, 0.004, 0.017, 0.042, 0.009, -.043, 0.000, 0.000, -.009, 0.038, 0.008, -.022, -.021,
     -.017, -.013, 0.000],
    [-.012, 0.012, 0.009, 0.008, 0.000, 0.009, -.064, -.009, 0.000, 0.000, 0.000, -.034, -.004, -.034, -.008, -.030,
     -.004, -.017, 0.000],
    [-.008, 0.043, 0.017, -.013, -.012, 0.004, -.005, 0.021, 0.000, 0.000, 0.000, -.012, 0.043, 0.008, -.004, 0.000,
     -.013, -.004, -.026],
    [0.004, 0.017, -.013, 0.013, -.005, 0.004, -.009, -.008, 0.000, 0.153, 0.000, -.017, 0.000, -.013, -.013, 0.017,
     -.013, 0.025, -.004],
    [0.013, 0.000, 0.030, 0.004, 0.012, 0.013, -.021, 0.008, -.021, 0.119, 0.000, -.009, 0.013, 0.017, 0.009, 0.005,
     0.008, 0.047, 0.021],
    [0.000, -.005, -.013, 0.000, -.004, 0.030, 0.009, 0.047, 0.000, -.106, 0.000, -.047, 0.004, 0.000, 0.004, -.005,
     0.012, 0.004, -.004],
    [-.005, 0.017, 0.021, 0.034, -.017, 0.026, 0.013, 0.025, 0.000, -.072, 0.000, -.026, 0.021, -.009, 0.008, 0.000,
     0.051, 0.000, -.004],
    [-.006, 0.004, 0.002, 0.004, 0.008, -.009, -.013, -.021, 0.000, 0.000, 0.000, -.014, 0.056, 0.007, -.017, 0.006,
     -.017, -.009, -.012],
    [0.006, 0.011, 0.008, 0.008, 0.005, -.008, 0.008, -.006, -.017, 0.000, 0.000, -.015, 0.009, 0.000, 0.011, 0.008,
     0.015, 0.004, 0.010],
    [0.000, -.006, 0.002, 0.000, -.013, 0.004, 0.004, -.004, 0.000, 0.000, 0.000, -.010, -.004, -.006, -.003, -.007,
     -.015, -.015, 0.002],
    [0.017, -.007, 0.006, 0.002, -.007, 0.003, 0.017, -.002, 0.000, 0.000, 0.000, -.002, 0.009, -.002, 0.000, 0.002,
     0.004, 0.002, 0.003],
    [0.004, 0.013, 0.000, 0.002, 0.002, 0.004, 0.004, -.002, 0.000, 0.000, 0.000, -.004, -.004, 0.009, 0.004, -.004,
     0.004, 0.009, 0.002],
    [0.000, 0.002, 0.006, 0.002, 0.000, 0.004, 0.000, 0.006, 0.004, 0.000, 0.000, -.002, 0.000, -.002, -.002, -.002,
     0.000, 0.004, 0.002],
    [0.002, 0.002, -.008, 0.009, -.002, -.004, -.002, 0.017, 0.000, 0.000, 0.000, -.004, 0.011, 0.000, 0.000, 0.000,
     0.007, 0.000, 0.000],
    [-.004, 0.009, -.008, 0.002, 0.011, -.011, 0.011, 0.009, 0.000, 0.000, 0.000, -.006, 0.013, 0.004, 0.004, 0.000,
     0.004, 0.007, 0.000],
    [-.009, 0.019, -.011, 0.017, -.007, 0.002, -.017, 0.000, 0.000, 0.000, 0.000, -.019, -.022, 0.000, 0.017, 0.000,
     0.012, -.010, 0.000],
    [0.013, -.013, -.017, -.009, 0.000, -.004, -.009, 0.017, -.046, 0.000, 0.000, -.030, -.013, 0.004, 0.017, 0.012,
     0.000, -.013, 0.009],
    [-.017, 0.013, 0.000, 0.000, 0.013, 0.013, -.026, 0.017, 0.000, 0.000, 0.000, -.013, 0.012, -.004, 0.004, 0.030,
     -.013, 0.009, 0.030],
    [-.013, 0.000, 0.021, 0.000, 0.008, -.008, -.005, -.004, 0.000, 0.000, 0.000, -.043, -.025, -.025, -.005, -.013,
     -.030, 0.000, -.013],
    [0.004, -.022, -.017, -.013, -.005, 0.013, -.021, 0.004, 0.000, 0.183, 0.000, -.013, -.026, -.017, -.005, -.030,
     0.009, -.009, 0.000],
    [0.039, 0.022, 0.000, 0.021, -.012, -.021, 0.013, 0.000, 0.034, 0.055, 0.000, -.017, -.047, 0.021, 0.000, 0.009,
     0.026, -.012, -.034],
    [0.030, -.022, 0.000, 0.000, 0.012, 0.021, 0.000, 0.009, 0.000, -.021, 0.000, -.009, -.004, 0.009, 0.000, -.008,
     0.013, 0.039, 0.009],
    [-.013, 0.017, 0.004, 0.013, -.008, -.004, 0.009, 0.004, 0.000, -.102, 0.000, 0.000, 0.000, 0.000, 0.034, 0.008,
     -.013, -.004, 0.000],
    [-.004, 0.021, 0.004, 0.032, 0.004, -.004, -.021, -.007, 0.000, 0.000, 0.000, -.030, -.034, -.011, 0.019, -.010,
     0.002, -.006, 0.014],
    [0.005, 0.005, -.002, -.022, 0.013, 0.002, 0.010, -.003, 0.036, 0.000, 0.000, 0.002, -.005, 0.009, 0.006, -.006,
     0.004, -.002, -.007],
    [-.006, 0.009, 0.002, -.013, 0.009, 0.000, -.015, 0.002, 0.000, 0.000, 0.000, -.011, -.007, 0.004, -.012, 0.000,
     0.014, -.002, 0.009],
    [0.002, 0.000, 0.004, 0.004, 0.002, 0.006, 0.005, 0.004, 0.000, 0.000, 0.000, -.004, 0.000, 0.002, 0.004, 0.004,
     0.000, 0.007, 0.000],
    [-.005, -.005, 0.004, 0.000, -.002, -.012, 0.000, -.004, 0.000, 0.000, 0.000, -.023, -.012, 0.004, -.004, -.013,
     0.000, 0.015, -.008],
    [0.008, -.002, 0.000, 0.000, -.002, -.011, 0.000, 0.013, 0.023, 0.000, 0.000, -.017, -.011, -.010, -.009, 0.005,
     -.002, -.012, 0.000],
    [0.009, 0.004, -.013, -.003, 0.000, 0.004, -.002, 0.000, 0.000, 0.000, 0.000, -.015, -.004, -.005, -.004, 0.004,
     -.008, -.002, -.006],
    [-.019, -.004, -.009, -.019, -.019, -.007, 0.002, 0.010, 0.000, 0.000, 0.000, -.036, -.026, -.025, -.015, -.017,
     -.011, -.008, -.011]
]

PSM_SC = [
    [-.015, -.030, -.023, -.028, -.014, -.002, -.019, -.036, 0.000, 0.000, 0.000, 0.008, 0.004, 0.026, -.008, 0.000,
     -.002, -.005, -.011],
    [-.034, 0.005, 0.000, 0.017, -.013, -.029, 0.013, 0.000, -.114, 0.000, 0.000, -.013, -.004, -.009, 0.047, 0.004,
     -.005, -.013, 0.004],
    [-.004, -.004, -.005, -.004, 0.013, -.017, 0.021, -.013, 0.000, 0.000, 0.000, -.004, -.008, 0.013, -.021, 0.004,
     -.008, 0.000, -.013],
    [0.000, -.008, 0.000, -.013, 0.030, 0.005, -.004, -.051, 0.000, 0.000, 0.000, -.038, -.004, 0.013, 0.017, -.009,
     -.005, 0.017, -.022],
    [-.038, -.017, 0.004, -.029, -.012, -.008, 0.000, 0.009, 0.000, 0.021, 0.000, 0.038, -.017, 0.017, -.021, -.021,
     -.013, -.030, -.034],
    [0.000, -.038, -.026, 0.017, 0.004, -.004, 0.000, 0.026, 0.009, -.017, 0.000, 0.064, -.012, -.013, -.004, 0.012,
     -.009, -.017, -.009],
    [0.000, 0.021, 0.025, 0.000, -.012, -.013, -.012, 0.012, 0.000, -.059, 0.000, 0.064, -.021, -.005, 0.021, 0.005,
     0.017, -.008, 0.005],
    [-.012, -.030, -.008, -.013, 0.017, 0.012, -.017, 0.034, 0.000, -.152, 0.000, 0.076, -.013, 0.022, 0.000, 0.013,
     -.017, 0.021, 0.004],
    [0.002, -.034, 0.030, -.022, -.019, -.002, -.021, -.053, 0.000, 0.000, 0.000, 0.059, -.013, 0.022, -.039, -.032,
     -.010, -.015, -.005],
    [0.004, -.013, 0.013, 0.002, 0.009, 0.000, 0.004, -.007, -.008, 0.000, 0.000, 0.011, -.002, 0.005, -.004, 0.010,
     0.002, -.009, 0.009],
    [0.003, 0.002, 0.011, 0.000, -.002, 0.012, -.014, -.006, 0.000, 0.000, 0.000, 0.043, -.011, -.004, 0.026, 0.007,
     -.008, -.002, -.019],
    [0.002, -.004, -.004, 0.000, 0.000, 0.004, 0.004, 0.004, 0.000, 0.000, 0.000, 0.013, 0.002, 0.007, -.004, 0.009,
     0.017, -.002, 0.002],
    [0.002, 0.000, -.003, 0.007, 0.004, -.015, 0.010, -.022, 0.000, 0.000, 0.000, 0.004, -.002, -.003, 0.011, -.006,
     -.015, -.017, -.015],
    [-.002, -.004, 0.009, -.007, 0.007, 0.000, 0.000, 0.002, -.015, 0.000, 0.000, -.003, -.006, 0.008, 0.000, 0.017,
     0.002, -.007, 0.006],
    [0.000, 0.013, 0.013, 0.021, -.002, 0.000, 0.000, 0.015, 0.000, 0.000, 0.000, 0.003, -.009, 0.013, -.002, 0.006,
     0.008, 0.007, 0.010],
    [0.002, -.021, -.008, -.015, -.025, 0.011, -.006, -.006, 0.000, 0.000, 0.000, 0.002, -.027, -.006, -.011, -.010,
     -.004, -.013, 0.008],
    [0.000, -.015, -.002, -.002, -.002, -.002, -.022, -.006, 0.000, 0.000, -.019, 0.017, 0.015, -.026, 0.002, -.007,
     0.000, -.007, 0.006],
    [-.022, -.005, 0.000, -.004, -.005, -.013, 0.034, -.017, -.004, 0.000, 0.242, -.013, 0.000, -.008, -.034, -.017,
     -.013, 0.004, -.013],
    [-.004, 0.004, 0.012, 0.000, 0.009, -.021, 0.017, -.013, 0.000, 0.000, 0.233, -.004, 0.004, 0.000, 0.013, 0.000,
     -.021, 0.004, -.004],
    [-.004, -.012, -.026, -.008, -.034, 0.008, -.008, 0.004, 0.000, 0.000, 0.013, 0.004, 0.013, 0.000, 0.004, 0.004,
     -.013, 0.008, 0.000],
    [-.013, 0.004, 0.008, -.004, -.009, -.008, -.009, -.009, 0.000, 0.093, 0.021, 0.038, -.017, 0.000, 0.013, -.013,
     0.021, 0.008, -.009],
    [-.038, -.013, -.022, -.013, 0.030, 0.013, -.025, -.055, -.022, 0.055, 0.118, 0.026, 0.038, 0.017, 0.025, 0.017,
     0.008, -.004, 0.033],
    [0.034, 0.017, -.017, 0.008, 0.008, 0.017, 0.009, 0.004, 0.000, -.085, 0.165, 0.026, 0.009, -.009, 0.013, 0.034,
     0.013, 0.005, -.004],
    [-.009, 0.004, 0.000, -.008, 0.000, 0.013, 0.025, 0.026, 0.000, -.064, -.093, 0.030, 0.034, -.017, -.008, -.009,
     0.000, 0.025, -.009],
    [0.006, 0.000, 0.002, -.019, -.004, -.012, -.017, 0.002, 0.000, 0.000, -.057, 0.055, 0.030, -.032, 0.006, -.004,
     0.002, -.011, 0.010],
    [0.000, 0.011, 0.006, 0.004, 0.010, 0.002, 0.013, 0.005, 0.036, 0.000, -.049, 0.021, -.004, -.009, -.004, 0.017,
     0.017, 0.010, 0.000],
    [0.006, 0.006, -.013, 0.006, -.002, 0.010, 0.006, -.008, 0.000, 0.000, -.031, 0.011, 0.006, 0.009, 0.004, 0.000,
     -.004, 0.024, 0.012],
    [0.004, 0.000, 0.009, 0.004, -.002, 0.000, 0.004, -.002, 0.000, 0.000, -.017, 0.013, 0.000, 0.000, -.006, 0.000,
     -.002, -.002, 0.002],
    [0.017, -.017, 0.010, -.005, -.002, -.013, 0.000, 0.004, 0.000, 0.000, -.061, -.011, 0.007, 0.015, 0.005, 0.015,
     -.002, 0.006, 0.002],
    [-.008, -.002, -.004, -.002, 0.000, 0.006, 0.008, -.004, 0.045, 0.000, -.019, -.017, 0.023, 0.019, 0.000, -.003,
     0.007, 0.002, 0.017],
    [0.004, 0.000, -.006, 0.006, 0.007, -.004, 0.002, 0.004, 0.000, 0.000, -.023, -.007, 0.007, -.008, -.007, -.002,
     0.000, 0.013, 0.012],
    [0.015, 0.000, 0.005, 0.009, 0.009, 0.006, 0.013, 0.011, 0.000, 0.000, -.091, -.013, 0.005, -.005, 0.000, 0.006,
     0.002, -.011, -.011],
    [-.010, 0.000, 0.008, 0.013, 0.000, -.002, -.011, -.015, 0.000, 0.000, 0.000, -.010, 0.036, 0.013, -.011, -.004,
     -.013, -.004, -.002],
    [-.021, 0.008, -.009, -.008, 0.004, 0.017, 0.042, 0.009, -.043, 0.000, 0.000, -.009, 0.038, 0.008, -.022, -.021,
     -.017, -.013, 0.000],
    [-.012, 0.012, 0.009, 0.008, 0.000, 0.009, -.064, -.009, 0.000, 0.000, 0.000, -.034, -.004, -.034, -.008, -.030,
     -.004, -.017, 0.000],
    [-.008, 0.043, 0.017, -.013, -.012, 0.004, -.005, 0.021, 0.000, 0.000, 0.000, -.012, 0.043, 0.008, -.004, 0.000,
     -.013, -.004, -.026],
    [0.004, 0.017, -.013, 0.013, -.005, 0.004, -.009, -.008, 0.000, 0.153, 0.000, -.017, 0.000, -.013, -.013, 0.017,
     -.013, 0.025, -.004],
    [0.013, 0.000, 0.030, 0.004, 0.012, 0.013, -.021, 0.008, -.021, 0.119, 0.000, -.009, 0.013, 0.017, 0.009, 0.005,
     0.008, 0.047, 0.021],
    [0.000, -.005, -.013, 0.000, -.004, 0.030, 0.009, 0.047, 0.000, -.106, 0.000, -.047, 0.004, 0.000, 0.004, -.005,
     0.012, 0.004, -.004],
    [-.005, 0.017, 0.021, 0.034, -.017, 0.026, 0.013, 0.025, 0.000, -.072, 0.000, -.026, 0.021, -.009, 0.008, 0.000,
     0.051, 0.000, -.004],
    [-.006, 0.004, 0.002, 0.004, 0.008, -.009, -.013, -.021, 0.000, 0.000, 0.000, -.014, 0.056, 0.007, -.017, 0.006,
     -.017, -.009, -.012],
    [0.006, 0.011, 0.008, 0.008, 0.005, -.008, 0.008, -.006, -.017, 0.000, 0.000, -.015, 0.009, 0.000, 0.011, 0.008,
     0.015, 0.004, 0.010],
    [0.000, -.006, 0.002, 0.000, -.013, 0.004, 0.004, -.004, 0.000, 0.000, 0.000, -.010, -.004, -.006, -.003, -.007,
     -.015, -.015, 0.002],
    [0.017, -.007, 0.006, 0.002, -.007, 0.003, 0.017, -.002, 0.000, 0.000, 0.000, -.002, 0.009, -.002, 0.000, 0.002,
     0.004, 0.002, 0.003],
    [0.004, 0.013, 0.000, 0.002, 0.002, 0.004, 0.004, -.002, 0.000, 0.000, 0.000, -.004, -.004, 0.009, 0.004, -.004,
     0.004, 0.009, 0.002],
    [0.000, 0.002, 0.006, 0.002, 0.000, 0.004, 0.000, 0.006, 0.004, 0.000, 0.000, -.002, 0.000, -.002, -.002, -.002,
     0.000, 0.004, 0.002],
    [0.002, 0.002, -.008, 0.009, -.002, -.004, -.002, 0.017, 0.000, 0.000, 0.000, -.004, 0.011, 0.000, 0.000, 0.000,
     0.007, 0.000, 0.000],
    [-.004, 0.009, -.008, 0.002, 0.011, -.011, 0.011, 0.009, 0.000, 0.000, 0.000, -.006, 0.013, 0.004, 0.004, 0.000,
     0.004, 0.007, 0.000],
    [-.009, 0.019, -.011, 0.017, -.007, 0.002, -.017, 0.000, 0.000, 0.000, 0.000, -.019, -.022, 0.000, 0.017, 0.000,
     0.012, -.010, 0.000],
    [0.013, -.013, -.017, -.009, 0.000, -.004, -.009, 0.017, -.046, 0.000, 0.000, -.030, -.013, 0.004, 0.017, 0.012,
     0.000, -.013, 0.009],
    [-.017, 0.013, 0.000, 0.000, 0.013, 0.013, -.026, 0.017, 0.000, 0.000, 0.000, -.013, 0.012, -.004, 0.004, 0.030,
     -.013, 0.009, 0.030],
    [-.013, 0.000, 0.021, 0.000, 0.008, -.008, -.005, -.004, 0.000, 0.000, 0.000, -.043, -.025, -.025, -.005, -.013,
     -0.03, 0.000, -.013],
    [0.004, -.022, -.017, -.013, -.005, 0.013, -.021, 0.004, 0.000, 0.183, 0.000, -.013, -.026, -.017, -.005, -.030,
     0.009, -.009, 0.000],
    [0.039, 0.022, 0.000, 0.021, -.012, -.021, 0.013, 0.000, 0.034, 0.055, 0.000, -.017, -.047, 0.021, 0.000, 0.009,
     0.026, -.012, -.034],
    [0.030, -.022, 0.000, 0.000, 0.012, 0.021, 0.000, 0.009, 0.000, -.021, 0.000, -.009, -.004, 0.009, 0.000, -.008,
     0.013, 0.039, 0.009],
    [-.013, 0.017, 0.004, 0.013, -.008, -.004, 0.009, 0.004, 0.000, -.102, 0.000, 0.000, 0.000, 0.000, 0.034, 0.008,
     -.013, -.004, 0.000],
    [-.004, 0.021, 0.004, 0.032, 0.004, -.004, -.021, -.007, 0.000, 0.000, 0.000, -.030, -.034, -.011, 0.019, -.010,
     0.002, -.006, 0.014],
    [0.005, 0.005, -.002, -.022, 0.013, 0.002, 0.010, -.003, 0.036, 0.000, 0.000, 0.002, -.005, 0.009, 0.006, -.006,
     0.004, -.002, -.007],
    [-.006, 0.009, 0.002, -.013, 0.009, 0.000, -.015, 0.002, 0.000, 0.000, 0.000, -.011, -.007, 0.004, -.012, 0.000,
     0.014, -.002, 0.009],
    [0.002, 0.000, 0.004, 0.004, 0.002, 0.006, 0.005, 0.004, 0.000, 0.000, 0.000, -.004, 0.000, 0.002, 0.004, 0.004,
     0.000, 0.007, 0.000],
    [-.005, -.005, 0.004, 0.000, -.002, -.012, 0.000, -.004, 0.000, 0.000, 0.000, -.023, -.012, 0.004, -.004, -.013,
     0.000, 0.015, -.008],
    [0.008, -.002, 0.000, 0.000, -.002, -.011, 0.000, 0.013, 0.023, 0.000, 0.000, -.017, -.011, -.010, -.009, 0.005,
     -.002, -.012, 0.000],
    [0.009, 0.004, -.013, -.003, 0.000, 0.004, -.002, 0.000, 0.000, 0.000, 0.000, -.015, -.004, -.005, -.004, 0.004,
     -.008, -.002, -.006],
    [-.019, -.004, -.009, -.019, -.019, -.007, 0.002, 0.010, 0.000, 0.000, 0.000, -.036, -.026, -.025, -.015, -.017,
     -.011, -.008, -.011]
]


def encode_pstp(sequence: str, species: str = 'hs'):
    psm = []
    results = []

    match species:
        case 'hs':
            psm = PSM_HS
        case 'sc':
            psm = PSM_SC
        case 'mm':
            psm = PSM_MM

    for i in range(len(sequence) - 2):
        match sequence[i: i + 3]:
            case 'AAA':
                results.append(psm[0][i])
            case 'AAU':
                results.append(psm[1][i])
            case 'AAC':
                results.append(psm[2][i])
            case 'AAG':
                results.append(psm[3][i])
            case 'AUA':
                results.append(psm[4][i])
            case 'AUU':
                results.append(psm[5][i])
            case 'AUC':
                results.append(psm[6][i])
            case 'AUG':
                results.append(psm[7][i])
            case 'ACA':
                results.append(psm[8][i])
            case 'ACU':
                results.append(psm[9][i])
            case 'ACC':
                results.append(psm[10][i])
            case 'ACG':
                results.append(psm[11][i])
            case 'AGA':
                results.append(psm[12][i])
            case 'AGU':
                results.append(psm[13][i])
            case 'AGC':
                results.append(psm[14][i])
            case 'AGG':
                results.append(psm[15][i])
            case 'UAA':
                results.append(psm[16][i])
            case 'UAU':
                results.append(psm[17][i])
            case 'UAC':
                results.append(psm[18][i])
            case 'UAG':
                results.append(psm[19][i])
            case 'UUA':
                results.append(psm[20][i])
            case 'UUU':
                results.append(psm[21][i])
            case 'UUC':
                results.append(psm[22][i])
            case 'UUG':
                results.append(psm[23][i])
            case 'UCA':
                results.append(psm[24][i])
            case 'UCU':
                results.append(psm[25][i])
            case 'UCC':
                results.append(psm[26][i])
            case 'UCG':
                results.append(psm[27][i])
            case 'UGA':
                results.append(psm[28][i])
            case 'UGU':
                results.append(psm[29][i])
            case 'UGC':
                results.append(psm[30][i])
            case 'UGG':
                results.append(psm[31][i])
            case 'CAA':
                results.append(psm[32][i])
            case 'CAU':
                results.append(psm[33][i])
            case 'CAC':
                results.append(psm[34][i])
            case 'CAG':
                results.append(psm[35][i])
            case 'CUA':
                results.append(psm[36][i])
            case 'CUU':
                results.append(psm[37][i])
            case 'CUC':
                results.append(psm[38][i])
            case 'CUG':
                results.append(psm[39][i])
            case 'CCA':
                results.append(psm[40][i])
            case 'CCU':
                results.append(psm[41][i])
            case 'CCC':
                results.append(psm[42][i])
            case 'CCG':
                results.append(psm[43][i])
            case 'CGA':
                results.append(psm[44][i])
            case 'CGU':
                results.append(psm[45][i])
            case 'CGC':
                results.append(psm[46][i])
            case 'CGG':
                results.append(psm[47][i])
            case 'GAA':
                results.append(psm[48][i])
            case 'GAU':
                results.append(psm[49][i])
            case 'GAC':
                results.append(psm[50][i])
            case 'GAG':
                results.append(psm[51][i])
            case 'GUA':
                results.append(psm[52][i])
            case 'GUU':
                results.append(psm[53][i])
            case 'GUC':
                results.append(psm[54][i])
            case 'GUG':
                results.append(psm[55][i])
            case 'GCA':
                results.append(psm[56][i])
            case 'GCU':
                results.append(psm[57][i])
            case 'GCC':
                results.append(psm[58][i])
            case 'GCG':
                results.append(psm[59][i])
            case 'GGA':
                results.append(psm[60][i])
            case 'GGU':
                results.append(psm[61][i])
            case 'GGC':
                results.append(psm[62][i])
            case 'GGG':
                results.append(psm[63][i])

    return results


class PSTP(Encoding):
    def __init__(self, species: str = 'hs'):
        self._species = species

    @property
    def name(self) -> str:
        return 'pstp'

    def encode(self, sequence: str, label: bool = False) -> list[Any]:
        return encode_pstp(sequence, self._species)
